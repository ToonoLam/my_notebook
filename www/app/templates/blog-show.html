{% extends 'base-content.html' %}

{% block title %}{{ blog.name }}{% endblock %}

{% block beforehead %}
<link rel="stylesheet" href="/static/css/blog-show.css">
{% endblock %}


{% block major_content %}

<div class="container">

    <article class="blog-post">
        <div class="blog-post-head">
            <h1 class="blog-post-title">{{ blog.name }}</h1>
            <p class="blog-post-meta">发表于
                <time>{{ blog.created_at|datetime }}</time>
            </p>
        </div>
        <p>{{ blog.content|marked|safe }}</p>
    </article>
    <div class="comment" id="blog-comment">

        <h4>最新评论</h4>
        <ul class="media-list">
            <li class="media" v-for="c in comments" track-by="id">
                <div class="media-left">
                    <!-- v-bind可以省略不写 -->
                    <img class="media-object img-thumbnail" v-bind:src="c.user_image" alt="user_image" width="150"
                         height="150"/>
                </div>
                <div class="media-body">
                    <h4 class="media-heading" v-text="c.user_name"></h4>
                    <small v-text="'发表于 ' + c.created_at.toDateTime('yyyy-MM-dd')"></small>
                    <hr class="divider"/>
                    <article>
                        <p v-html="c.content"></p>
                    </article>
                </div>
                <hr class="divider"/>
            </li>
        </ul><!-- media-list -->
        <hr class="divider"/>

        {% if __user__ %}

        <form class="form" v-on:submit.prevent="submit">
            <div class="form-group">
                <button class="btn btn-primary" style="display: inline;"><h4>添加评论</h4></button>

                <span class="alert alert-danger" hidden="hidden" style="margin: 15px;">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    <span class="sr-only">Error:</span>
                    <span v-text="message"></span>
                </span>
            </div>
            <div class="form-group col-sm-6" style="padding-left: 0;">
                <textarea class="form-control" rows="15" id="comment" name="comment" placeholder="内容"
                          v-model="comment"></textarea>
            </div>
            <div class="col-sm-6 pre-scrollable" style="border-radius: 4px; height: 313px; box-shadow: 0 0 3px #888888;" v-html="comment|marked"></div>
        </form>

        {% endif %}
    </div>
</div>
{% if __user__ is none %}
<div class="check-sign">
    <h4>请<a href="/bootstrap/signin">登陆</a>后再评论，如未注册请先<a href="/bootstrap/signup">注册</a></h4>
</div>
{% endif %}
{% endblock %}

{% block script %}
<script src="/static/js/cdls/vue.min.js"></script>
<script src="/static/js/cdls/marked.min.js"></script>
<script src="/static/js/blog_show.js"></script>
{% endblock %}